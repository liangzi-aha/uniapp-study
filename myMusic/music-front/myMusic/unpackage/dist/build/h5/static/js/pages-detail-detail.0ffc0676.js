(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-detail-detail"],{"257f":function(i,t,a){var e=a("24fb"),n=a("1de5"),o=a("a665"),r=a("361d");t=e(!1);var s=n(o),c=n(r);t.push([i.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* uni.scss */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.detail[data-v-5c754272]{height:100vh}.detail .container[data-v-5c754272]{height:calc(100vh - 75px);box-sizing:border-box;overflow:hidden}.detail .container uni-scroll-view[data-v-5c754272]{height:100%!important;box-sizing:border-box}.detail .detail-lyric[data-v-5c754272]{font-size:%?32?%;line-height:%?82?%;height:%?246?%;text-align:center;overflow:hidden;color:#6f6e73;margin-top:%?40?%}.detail .detail-lyric .detail-lyric-wrap[data-v-5c754272]{-webkit-transform:.5s;transform:.5s}.detail .detail-lyric .detail-lyric-wrap .detail-lyric-item[data-v-5c754272]{height:%?82?%}.detail .detail-lyric .detail-lyric-wrap .active[data-v-5c754272]{color:#fff}.detail .detail-play[data-v-5c754272]{width:%?580?%;height:%?580?%;background:url('+s+");background-size:cover;margin:%?214?% auto 0;position:relative}.detail .detail-play uni-image[data-v-5c754272]{border-radius:50%;width:%?370?%;height:%?370?%;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;-webkit-animation:10s linear move-data-v-5c754272 infinite;animation:10s linear move-data-v-5c754272 infinite;-webkit-animation-play-state:paused;animation-play-state:paused}.detail .detail-play .detail-play-run[data-v-5c754272]{-webkit-animation-play-state:running;animation-play-state:running}@-webkit-keyframes move-data-v-5c754272{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes move-data-v-5c754272{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.detail .detail-play uni-text[data-v-5c754272]{width:%?100?%;height:%?100?%;font-size:%?100?%;color:#fff;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.detail .detail-play .pause-vidio[data-v-5c754272]{-webkit-transform:rotate(-20deg);transform:rotate(-20deg)}.detail .detail-play uni-view[data-v-5c754272]{width:%?230?%;height:%?360?%;background:url("+c+");position:absolute;left:%?100?%;right:0;top:%?-200?%;margin:auto;background-size:cover;-webkit-transform:.5s;transform:.5s;-webkit-transform-origin:%?10?% %?20?%;transform-origin:%?10?% %?20?%}.detail .playMusic-play[data-v-5c754272]{padding:%?50?% %?30?%;display:flex;align-items:center;justify-content:space-between}.detail .playMusic-play .loveMusic[data-v-5c754272]{color:#b84343}.detail .playMusic-play uni-text[data-v-5c754272]{font-size:%?60?%;margin:0 %?35?%}.detail .playMusic-play uni-text[data-v-5c754272]:nth-child(3){font-size:%?90?%}",""]),i.exports=t},"2f0d":function(i,t,a){var e=a("257f");"string"===typeof e&&(e=[[i.i,e,""]]),e.locals&&(i.exports=e.locals);var n=a("4f06").default;n("af7e8bf6",e,!0,{sourceMap:!1,shadowMode:!1})},"3bc7":function(i,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return e}));var e={musichead:a("53c7").default,bingProgress:a("522d").default},n=function(){var i=this,t=i.$createElement,a=i._self._c||t;return a("v-uni-view",{staticClass:"detail"},[i.isLoading?i._e():a("v-uni-view",{staticClass:"fixbg",style:{"background-image":"url("+i.urlReplace(i.songDetail.musicImg)+")"}}),a("musichead",{attrs:{title:i.songDetail.musicName,icon:!0,color:"white"}}),i.isLoading?i._e():a("v-uni-view",{staticClass:"container"},[a("v-uni-scroll-view",{attrs:{"scroll-y":"true"}},[a("v-uni-view",{staticClass:"detail-play",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.handlePlay.apply(void 0,arguments)}}},[a("v-uni-image",{class:{"detail-play-run":i.isPlayMusic},attrs:{src:i.urlReplace(i.songDetail.musicImg)}}),a("v-uni-text",{staticClass:"iconfont",class:i.isPlayMusic?"icon-pause":"icon-bofang"}),a("v-uni-view",{class:{"pause-vidio":!i.isPlayMusic}})],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:i.songLyric.length>0,expression:"songLyric.length > 0"}],staticClass:"detail-lyric"},[a("v-uni-view",{staticClass:"detail-lyric-wrap",style:{marginTop:82*-(i.lyricIndex-1)+"rpx"}},i._l(i.songLyric,(function(t,e){return a("v-uni-view",{key:e,staticClass:"detail-lyric-item",class:{active:i.lyricIndex==e}},[i._v(i._s(t.lyric))])})),1)],1),a("bing-progress",{attrs:{strokeWidth:"5px",handleWidth:"20px",value:i.value,handleHeight:"20px",handleColor:"#aca2a2",noActiveColor:"rgb(83,83,83)",activeColor:"rgb(199,12,12)",showInfo:!1,handleBorderRadius:"10px"},on:{dragend:function(t){arguments[0]=t=i.$handleEvent(t),i.sliderChange.apply(void 0,arguments)},dragstart:function(t){arguments[0]=t=i.$handleEvent(t),i.dragstart.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"playMusic-play"},[a("v-uni-text",{class:i.LoopPlayback?"iconfont icon-24gl-repeatOnce2":"iconfont icon-24gl-repeat2",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.handleLoopPlayback.apply(void 0,arguments)}}}),a("v-uni-text",{staticClass:"iconfont icon-yduishangyiqu",on:{click:function(t){t.stopPropagation(),arguments[0]=t=i.$handleEvent(t),i.UpMusic()}}}),a("v-uni-text",{class:i.isPlayMusic?"iconfont icon-pause":"iconfont icon-bofang",on:{click:function(t){t.stopPropagation(),arguments[0]=t=i.$handleEvent(t),i.handlePlay()}}}),a("v-uni-text",{staticClass:"iconfont icon-yduixiayiqu",on:{click:function(t){t.stopPropagation(),arguments[0]=t=i.$handleEvent(t),i.nextMusic(i.songDetail.id)}}}),a("v-uni-text",{class:i.isLoveMusic?"iconfont icon-aixin1 loveMusic":"iconfont icon-aixin",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.loveMusic.apply(void 0,arguments)}}})],1)],1)],1)],1)},o=[]},"73f7":function(i,t,a){"use strict";var e=a("2f0d"),n=a.n(e);n.a},8392:function(i,t,a){"use strict";a.r(t);var e=a("f2ab"),n=a.n(e);for(var o in e)"default"!==o&&function(i){a.d(t,i,(function(){return e[i]}))}(o);t["default"]=n.a},ebbb:function(i,t,a){"use strict";a.r(t);var e=a("3bc7"),n=a("8392");for(var o in n)"default"!==o&&function(i){a.d(t,i,(function(){return n[i]}))}(o);a("73f7");var r,s=a("f0c5"),c=Object(s["a"])(n["default"],e["b"],e["c"],!1,null,"5c754272",null,!1,e["a"],r);t["default"]=c.exports},f2ab:function(i,t,a){"use strict";var e=a("4ea4");a("d3b7"),a("ac1f"),a("3ca3"),a("5319"),a("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=e(a("e143")),o=e(a("7155")),r={data:function(){return{songDetail:{musicImg:""},isPlayMusic:!0,isLoading:!0,baseImgUrl:this.$imgBaseUrl,value:0,time:"",LoopPlayback:!1,isLoveMusic:!1,songLyric:[],lyricIndex:0}},onLoad:function(i){this.getMusic(i.songId),n.default.prototype.$nextMusic=function(i){uni.redirectTo({url:"/pages/detail/detail?songId="+i})};var t=uni.getStorageSync("LoopPlayback");this.LoopPlayback=!!t},onHide:function(){this.clearTime()},onShow:function(){this.sliderInterval()},onUnload:function(){this.clearTime()},methods:{getMusic:function(i){var t=this;this.$getNextMusic(i),this.lyricIndex=0,this.isLoading=!0;var a=this.$api,e=a.musicDetail,n=a.lyric;Promise.all([n(i),e(i)]).then((function(i){if(i[0].success&&i[0].data){var a=i[0].data,e=/\[([^\]]+)\]([^\[]+)/g,n=[];a.replace(e,(function(i,a,e){n.push({time:t.$formatTimeToSec(a),lyric:e.replace(/\r\n/g,"")})})),t.songLyric=n}else t.songLyric=[];if(uni.setStorageSync("lyric",t.songLyric),i[1].success){t.songDetail=i[1].data[0],uni.setStorage({key:"songDetail",data:i[1].data[0]}),t.$CreateBgAudioManager(t.songDetail.musicName,(function(i){t.isPlayMusic=i}),t.urlReplace(t.songDetail.musicUrl),t.urlReplace(t.songDetail.musicImg),t.sliderInterval,t.clearTime,t.nextMusic,t.UpMusic);var r=uni.getStorageSync("userToken");if(r){var s=o.default.verify(r).data.id;t.playLoveMusic(s,t.songDetail.id)}}t.isLoading=!1}))},UpMusic:function(i){this.clearTime(),this.value=0;var t=uni.getStorageSync("UpMusicId");this.getMusic(t)},nextMusic:function(i){this.clearTime(),this.value=0;var t=uni.getStorageSync("nextMusicId");this.getMusic(t)},handlePlay:function(){this.$bgAudioManager.paused?this.$bgAudioManager.play():this.$bgAudioManager.pause()},urlReplace:function(i){return this.baseImgUrl+i.replace(/\\/g,"/")},dragstart:function(){this.clearTime()},sliderChange:function(i){if(this.value=i.value,this.$bgAudioManager){var t=this.$bgAudioManager.duration;this.$bgAudioManager.seek(this.value/100*t);for(var a=this.value/100*t,e=0;e<this.songLyric.length;e++){if(a>this.songLyric[this.songLyric.length-1].time){this.lyricIndex=this.songLyric.length-1;break}if(a>this.songLyric[e].time&&a<this.songLyric[e+1].time){this.lyricIndex=e;break}}}},sliderInterval:function(){var i=this;if(clearInterval(this.time),this.$bgAudioManager&&!this.$bgAudioManager.paused){console.log("播放音乐计时器开始 + 进度条 + 歌词");var t=this.$bgAudioManager.duration;this.time=setInterval((function(){i.value=i.$bgAudioManager.currentTime/t*100;for(var a=i.lyricIndex;a<i.songLyric.length;a++){if(i.$bgAudioManager.currentTime>i.songLyric[i.songLyric.length-1].time){i.lyricIndex=i.songLyric.length-1;break}if(i.$bgAudioManager.currentTime>i.songLyric[a].time&&i.$bgAudioManager.currentTime<i.songLyric[a+1].time){i.lyricIndex=a;break}}}),500)}else console.log("没播放音乐")},clearTime:function(){clearInterval(this.time)},handleLoopPlayback:function(){this.LoopPlayback=!this.LoopPlayback,this.LoopPlayback?uni.setStorageSync("LoopPlayback",!0):uni.removeStorageSync("LoopPlayback")},playLoveMusic:function(i,t){var a=this,e=this.$api.playLoveMusic;e(i,t).then((function(i){a.isLoveMusic=i.isLove}))},loveMusic:function(){var i=this,t=uni.getStorageSync("userToken");if(t){var a=this.$api.changeLoveMusic,e=o.default.verify(t).data.id;a(e,this.songDetail.id).then((function(t){t.success&&(i.isLoveMusic=!i.isLoveMusic)}))}else uni.navigateTo({url:"../login/login"})}}};t.default=r}}]);